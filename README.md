# Тестовое задание

## Описание

В проекте реализованы два .NET сервиса:
- **Recalculator** — сервис пересчёта, предоставляющий два полноценных endpoint для получения периода максимального роста курса USD к EUR:
  - `/max-growth-rest` — взаимодействие с сервисом справочника (References) напрямую по REST (HTTP-запрос).
  - `/max-growth-rabbit` — взаимодействие с сервисом справочника через очередь RabbitMQ.

Оба варианта реализуют одинаковую бизнес-логику: принимают диапазон дат, запрашивают исторические курсы USD к EUR у сервиса References и возвращают клиенту период максимального прироста курса, курс на начало и конец периода, а также величину прироста.
- **References** — сервис-справочник курсов валют. По запросу возвращает исторические курсы USD к EUR за указанный диапазон дат. Получает данные из внешнего API ([Frankfurter](https://www.frankfurter.app/docs/)) в формате JSON.

**Логика работы сервисов**

- **REST:**
  1. Клиент отправляет запрос на endpoint `/max-growth-rest` сервиса Recalculator с диапазоном дат.
  2. Recalculator обращается к сервису References по HTTP (REST API), передавая указанный диапазон дат.
  3. References запрашивает исторические курсы USD к EUR у внешнего API Frankfurter и возвращает их Recalculator.
  4. Recalculator анализирует полученные данные, вычисляет период максимального прироста курса и возвращает результат клиенту.

- **RabbitMQ:**
  1. Клиент отправляет запрос на endpoint `/max-growth-rabbit` сервиса Recalculator с диапазоном дат.
  2. Recalculator публикует событие `UsdEuroEvent` в очередь RabbitMQ.
  3. References получает событие, обращается к Frankfurter API, формирует ответ `ResponseUsdEuroEvent` и публикует его в очередь.
  4. Recalculator анализирует полученные данные, вычисляет период максимального прироста курса и возвращает результат клиенту.

> В текущей реализации обмен сообщениями демонстрационный: сервисы обмениваются только диапазоном дат. Для полноценной бизнес-логики структуру сообщений и обработку ответа можно расширить.


## 1. Архитектурная секция: Взаимодействие сервисов

В рамках архитектурной задачи необходимо реализовать один из endpoint-ов, который на практике демонстрирует интеграцию и обмен данными между двумя независимыми сервисами — Recalculator и References.

## 2. Алгоритмическая секция: Максимальный рост курса USD к EUR

 endpoint на вход получает:
- диапазон дат (например, с 2000-12-01 по 2000-12-07)

Endpoint должен вернуть:
- даты начала и конца самого длинного периода максимального роста курса USD к EUR
- курс на начальную дату
- курс на конечную дату
- максимальный прирост (разницу между курсами)

**Пример 1:**

Входные параметры:
- from: 2000-12-01
- to: 2000-12-07

Входные данные (исторические курсы):

| Дата         | Курс USD/EUR |
|--------------|--------------|
| 2000-12-01   | 1.13         |
| 2000-12-02   | 1.12         |
| 2000-12-03   | 1.12         |
| 2000-12-04   | 1.15         |
| 2000-12-05   | 1.14         |
| 2000-12-06   | 1.18         |
| 2000-12-07   | 1.16         |

Как работает алгоритм:
- Максимальный прирост достигается с 2000-12-02 (1.12) до 2000-12-06 (1.18), прирост 0.06.

Ответ:
```json
{
  "start_date": "2000-12-04",
  "end_date": "2000-12-20",
  "rate_start": 1.12,
  "rate_end": 1.18,
  "max_growth": 0.06
}
```

**Пример 2:**

Входные параметры:
- from: 2000-12-01
- to: 2000-12-06

Входные данные (исторические курсы):

| Дата         | Курс USD/EUR |
|--------------|--------------|
| 2000-12-01   | 1.20         |
| 2000-12-02   | 1.18         |
| 2000-12-03   | 1.15         |
| 2000-12-04   | 1.13         |
| 2000-12-05   | 1.12         |
| 2000-12-06   | 1.12         |

Как работает алгоритм:
- Курс только падает, максимальный прирост — 0 (можно выбрать любую дату, где курс максимален).

Ответ:
```json
{
  "start_date": "2000-12-01",
  "end_date": "2000-12-01",
  "rate_start": 1.20,
  "rate_end": 1.20,
  "max_growth": 0.0
}
```

### Получение исторических курсов USD к EUR через Frankfurter API

Frankfurter API поддерживает получение временных рядов (time series) для валют:

**Пример запроса:**
```
GET https://api.frankfurter.dev/v1/2000-12-01..2000-12-31?base=USD&symbols=EUR
```
- `base=USD` — базовая валюта
- `symbols=EUR` — интересующая валюта
- диапазон дат задаётся через две точки в пути

**Документация:**
https://www.frankfurter.app/docs/#timeseries

**Пример ответа:**
```json
{
  "amount": 1,
  "base": "USD",
  "start_date": "2000-12-01",
  "end_date": "2000-12-31",
  "rates": {
    "2000-12-01": {"EUR": 1.13},
    "2000-12-04": {"EUR": 1.12},
    ...
    "2000-12-31": {"EUR": 1.18}
  }
}
```

## 3. Секция развертывания приложения: запуск через Docker Compose

1. Необходимо подключить Dockerfile каждого сервиса в файле docker-compose.yml и развернуть приложение с помощью Docker Compose.


